<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>OP_NET ‚Äî Bitcoin DeFi Hub ¬∑ Wallet Copilot ¬∑ MotoSwap</title>
<meta name="description" content="The ultimate Bitcoin L1 DeFi dashboard. Live BTC & MOTO charts, swap widget, wallet copilot, MotoCat pinball game and full OP_NET ecosystem.">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Space+Mono:ital,wght@0,400;0,700;1,400&family=Bebas+Neue&family=Syne:wght@400;600;700;800&display=swap" rel="stylesheet">
<style>
:root {
  --btc:#f7931a; --opnet:#ff6b2b; --dark:#080810; --card:#0f0f1a;
  --card2:#13131f; --border:rgba(247,147,26,0.15); --glow:rgba(247,147,26,0.1);
  --text:#e8e8f4; --muted:#5a5a72; --green:#00d68f; --red:#ff3d5a;
  --moto:#7c3aed; --cat:#ec4899; --pill:#10b981;
  --gold:#fbbf24; --blue:#3b82f6;
}
*{margin:0;padding:0;box-sizing:border-box;}
html{scroll-behavior:smooth;}
body{background:var(--dark);color:var(--text);font-family:'Syne',sans-serif;min-height:100vh;overflow-x:hidden;}

/* animated bg */
body::before{content:'';position:fixed;inset:0;z-index:0;
  background-image:linear-gradient(rgba(247,147,26,0.025) 1px,transparent 1px),linear-gradient(90deg,rgba(247,147,26,0.025) 1px,transparent 1px);
  background-size:48px 48px;pointer-events:none;animation:bgPan 60s linear infinite;}
@keyframes bgPan{from{background-position:0 0}to{background-position:48px 48px}}
body::after{content:'';position:fixed;inset:0;z-index:0;pointer-events:none;
  background:radial-gradient(ellipse 80% 50% at 50% -20%,rgba(124,58,237,0.08),transparent),
             radial-gradient(ellipse 60% 40% at 90% 80%,rgba(247,147,26,0.06),transparent);}

/* ‚ïê‚ïê TOPBAR ‚ïê‚ïê */
.topbar{position:sticky;top:0;z-index:200;display:flex;align-items:center;gap:12px;
  padding:0 20px;height:50px;background:rgba(8,8,16,0.94);backdrop-filter:blur(16px);
  border-bottom:1px solid var(--border);}
.logo{font-family:'Bebas Neue',sans-serif;font-size:22px;letter-spacing:2px;color:#fff;flex-shrink:0;}
.logo em{color:var(--btc);font-style:normal;}
.pill{display:flex;align-items:center;gap:5px;padding:3px 10px;border-radius:20px;
  font-family:'Space Mono',monospace;font-size:11px;border:1px solid;white-space:nowrap;flex-shrink:0;}
.pill-btc{border-color:rgba(247,147,26,0.35);background:rgba(247,147,26,0.08);color:var(--btc);}
.pill-moto{border-color:rgba(124,58,237,0.35);background:rgba(124,58,237,0.08);color:#a78bfa;}
.pill .chg{font-size:10px;}
.pill .chg.up{color:var(--green);}
.pill .chg.dn{color:var(--red);}
nav{display:flex;gap:2px;margin-left:auto;}
nav a{padding:5px 11px;border-radius:6px;font-size:12px;font-weight:600;color:var(--muted);text-decoration:none;transition:.15s;}
nav a:hover,nav a.on{color:var(--btc);}
.conn-btn{padding:6px 14px;background:linear-gradient(135deg,var(--btc),var(--opnet));color:#000;
  border:none;border-radius:7px;font-weight:800;font-size:12px;cursor:pointer;font-family:'Syne',sans-serif;
  transition:.15s;flex-shrink:0;}
.conn-btn:hover{opacity:.85;transform:translateY(-1px);}

/* ‚ïê‚ïê LAYOUT ‚ïê‚ïê */
.pg{position:relative;z-index:1;}
.wrap{max-width:1220px;margin:0 auto;padding:0 20px;}
.sec-title{font-size:11px;font-weight:700;letter-spacing:2.5px;text-transform:uppercase;color:var(--muted);
  margin-bottom:18px;display:flex;align-items:center;gap:10px;}
.sec-title::after{content:'';flex:1;height:1px;background:var(--border);}

/* ‚ïê‚ïê HERO ‚ïê‚ïê */
.hero{padding:56px 20px 36px;max-width:1220px;margin:0 auto;
  display:grid;grid-template-columns:1fr 1fr;gap:48px;align-items:center;}
.hero-h1{font-family:'Bebas Neue',sans-serif;font-size:clamp(48px,7vw,88px);line-height:.95;
  letter-spacing:2px;color:#fff;}
.hero-h1 em{font-style:normal;color:var(--btc);}
.hero-sub{color:var(--muted);font-size:14px;margin-top:14px;line-height:1.7;max-width:420px;}
.hero-btns{display:flex;gap:10px;margin-top:22px;flex-wrap:wrap;}
.btn-o{padding:10px 22px;border-radius:8px;font-weight:700;font-size:13px;cursor:pointer;
  font-family:'Syne',sans-serif;transition:.15s;text-decoration:none;display:inline-flex;align-items:center;gap:6px;}
.btn-solid{background:linear-gradient(135deg,var(--btc),#ff8c00);color:#000;border:none;}
.btn-solid:hover{opacity:.85;transform:translateY(-1px);}
.btn-ghost{background:transparent;color:var(--text);border:1px solid var(--border);}
.btn-ghost:hover{border-color:var(--moto);color:#a78bfa;}
.btn-pink{background:transparent;color:var(--cat);border:1px solid rgba(236,72,153,0.35);}
.btn-pink:hover{background:rgba(236,72,153,0.1);}
.stats-grid{display:grid;grid-template-columns:1fr 1fr;gap:12px;}
.sc{background:var(--card);border:1px solid var(--border);border-radius:12px;padding:16px;
  position:relative;overflow:hidden;transition:.2s;}
.sc::before{content:'';position:absolute;top:0;left:0;right:0;height:2px;
  background:linear-gradient(90deg,var(--btc),transparent);}
.sc:hover{border-color:rgba(247,147,26,0.35);transform:translateY(-2px);}
.sc-lbl{font-size:10px;color:var(--muted);font-weight:700;letter-spacing:1.5px;text-transform:uppercase;}
.sc-val{font-size:20px;font-weight:800;margin-top:6px;color:#fff;font-family:'Space Mono',monospace;}
.sc-sub{font-size:11px;color:var(--muted);margin-top:2px;}
.sc-sub.up{color:var(--green);}
.sc-sub.dn{color:var(--red);}

/* ‚ïê‚ïê HERO DEFI FLASH ‚ïê‚ïê */
.hero-defi{
  font-style:normal;color:var(--btc);position:relative;display:inline-block;
  animation:defiPulse 3s ease-in-out infinite;
}
@keyframes defiPulse{
  0%,100%{color:var(--btc);text-shadow:0 0 20px rgba(247,147,26,0.4);}
  20%{color:#fff;text-shadow:0 0 40px rgba(247,147,26,1),0 0 80px rgba(247,147,26,0.6),0 0 120px rgba(255,140,0,0.4);}
  22%{color:var(--btc);text-shadow:0 0 10px rgba(247,147,26,0.2);}
  40%{color:#ffe0a0;text-shadow:0 0 30px rgba(247,147,26,0.8),0 0 60px rgba(247,147,26,0.4);}
  60%{color:var(--btc);text-shadow:0 0 20px rgba(247,147,26,0.3);}
  80%{color:#fff;text-shadow:0 0 35px rgba(247,147,26,0.9),0 0 70px rgba(255,100,0,0.5);}
  82%{color:var(--cat);text-shadow:0 0 8px rgba(236,72,153,0.6);}
  84%{color:var(--btc);text-shadow:0 0 20px rgba(247,147,26,0.5);}
}

/* ‚ïê‚ïê MOTOCAT RIDER ‚ïê‚ïê */
#motoRider{
  position:fixed;bottom:80px;left:-160px;z-index:50;
  pointer-events:none;font-size:0;line-height:1;
  filter:drop-shadow(0 0 8px rgba(247,147,26,0.7));
  transition:none;
}
#motoRider.riding{animation:rideAcross 5s linear forwards;}
@keyframes rideAcross{
  from{left:-160px;bottom:80px;}
  to{left:calc(100vw + 160px);bottom:80px;}
}
#motoRider canvas{display:block;}

/* ‚ïê‚ïê SECOND GAME ‚Äî BTC MINER ‚ïê‚ïê */
.miner-card{background:var(--card);border:1px solid var(--border);border-radius:16px;
  padding:24px;position:relative;overflow:hidden;margin-top:16px;}
.miner-card::before{content:'';position:absolute;top:0;left:0;right:0;height:3px;
  background:linear-gradient(90deg,var(--btc),var(--green),var(--moto));}
.miner-title{font-family:'Bebas Neue',sans-serif;font-size:26px;letter-spacing:2px;margin-bottom:2px;}
.miner-sub{font-size:12px;color:var(--muted);margin-bottom:16px;}
.miner-layout{display:grid;grid-template-columns:1fr 200px;gap:16px;align-items:start;}
#minerCanvas{display:block;border-radius:10px;border:1px solid var(--border);
  background:#02020a;cursor:crosshair;width:100%;}
.miner-panel{display:flex;flex-direction:column;gap:10px;}
.mp-stat{background:rgba(247,147,26,0.07);border:1px solid rgba(247,147,26,0.2);
  border-radius:10px;padding:12px;text-align:center;}
.mp-stat-lbl{font-size:10px;color:var(--btc);font-weight:700;letter-spacing:1.5px;text-transform:uppercase;margin-bottom:4px;}
.mp-stat-val{font-family:'Bebas Neue',sans-serif;font-size:30px;color:#fff;line-height:1;}
.mp-upgrade{background:rgba(0,0,0,0.3);border-radius:8px;padding:10px;}
.mp-upgrade h4{font-size:11px;color:var(--muted);font-weight:700;text-transform:uppercase;letter-spacing:1px;margin-bottom:8px;}
.upgrade-btn{width:100%;padding:7px 10px;border-radius:6px;font-size:11px;font-weight:700;
  cursor:pointer;font-family:'Syne',sans-serif;transition:.15s;border:none;
  background:rgba(247,147,26,0.15);color:var(--btc);border:1px solid rgba(247,147,26,0.3);
  margin-bottom:5px;text-align:left;display:flex;justify-content:space-between;align-items:center;}
.upgrade-btn:hover:not(:disabled){background:rgba(247,147,26,0.25);}
.upgrade-btn:disabled{opacity:.35;cursor:not-allowed;}
.upgrade-btn .ub-cost{font-family:'Space Mono',monospace;font-size:10px;color:var(--gold);}
.hashbar{height:8px;border-radius:4px;background:rgba(255,255,255,0.08);overflow:hidden;margin-top:4px;}
.hashfill{height:100%;background:linear-gradient(90deg,var(--btc),var(--green));border-radius:4px;transition:.1s;}

/* ‚ïê‚ïê SWAP WIDGET ‚ïê‚ïê */
.swap-section{padding:0 20px 32px;max-width:1220px;margin:0 auto;}
.swap-grid{display:grid;grid-template-columns:380px 1fr;gap:16px;}
.swap-card{background:var(--card);border:1px solid var(--border);border-radius:16px;padding:24px;position:relative;overflow:hidden;}
.swap-card::before{content:'';position:absolute;top:0;left:0;right:0;height:3px;
  background:linear-gradient(90deg,var(--moto),var(--cat),var(--btc));}
.sw-title{font-size:17px;font-weight:800;margin-bottom:4px;}
.sw-sub{font-size:12px;color:var(--muted);margin-bottom:20px;}
.sw-box{background:rgba(255,255,255,0.04);border:1px solid var(--border);border-radius:10px;padding:14px;margin-bottom:8px;transition:.2s;}
.sw-box:focus-within{border-color:rgba(124,58,237,0.5);background:rgba(124,58,237,0.04);}
.sw-row{display:flex;align-items:center;gap:8px;margin-bottom:6px;}
.sw-label{font-size:11px;color:var(--muted);font-weight:600;letter-spacing:1px;text-transform:uppercase;flex:1;}
.sw-max{font-size:10px;color:var(--moto);cursor:pointer;font-weight:700;}
.sw-max:hover{text-decoration:underline;}
.sw-inner{display:flex;align-items:center;gap:8px;}
.sw-input{flex:1;background:transparent;border:none;outline:none;font-family:'Space Mono',monospace;
  font-size:22px;font-weight:700;color:#fff;min-width:0;}
.sw-input::placeholder{color:#2a2a40;}
.tok-btn{display:flex;align-items:center;gap:6px;background:rgba(255,255,255,0.06);
  border:1px solid var(--border);border-radius:8px;padding:6px 10px;cursor:pointer;
  font-weight:700;font-size:13px;white-space:nowrap;transition:.15s;color:var(--text);}
.tok-btn:hover{border-color:var(--moto);color:#a78bfa;}
.tok-dot{width:18px;height:18px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:9px;font-weight:900;flex-shrink:0;}
.tok-btc{background:#f7931a;color:#000;}
.tok-moto{background:linear-gradient(135deg,#7c3aed,#ec4899);color:#fff;}
.tok-pill{background:#10b981;color:#000;}
.tok-rbtc{background:#2a2a50;color:#f7931a;}
.sw-arrow-row{display:flex;justify-content:center;margin:4px 0;}
.sw-arrow{width:32px;height:32px;background:var(--card2);border:1px solid var(--border);
  border-radius:50%;display:flex;align-items:center;justify-content:center;cursor:pointer;
  font-size:14px;transition:.2s;}
.sw-arrow:hover{background:rgba(124,58,237,0.2);border-color:var(--moto);transform:rotate(180deg);}
.sw-rate{font-size:12px;color:var(--muted);text-align:center;margin:10px 0;font-family:'Space Mono',monospace;}
.sw-rate b{color:var(--text);}
.sw-details{background:rgba(0,0,0,0.3);border-radius:8px;padding:10px 14px;margin-bottom:14px;}
.sw-detail-row{display:flex;justify-content:space-between;font-size:11px;padding:3px 0;}
.sw-detail-row span{color:var(--muted);}
.sw-detail-row b{font-family:'Space Mono',monospace;font-size:11px;}
.sw-btn{width:100%;padding:14px;background:linear-gradient(135deg,var(--moto),var(--cat));color:#fff;
  border:none;border-radius:10px;font-weight:800;font-size:15px;cursor:pointer;
  font-family:'Syne',sans-serif;transition:.15s;letter-spacing:.5px;}
.sw-btn:hover{opacity:.88;transform:translateY(-1px);}
.sw-btn:disabled{opacity:.4;cursor:not-allowed;transform:none;}
.sw-btn.loading{animation:swPulse 1s infinite;}
@keyframes swPulse{50%{opacity:.6;}}
.sw-notice{font-size:11px;color:var(--muted);text-align:center;margin-top:10px;}
.sw-notice a{color:var(--moto);text-decoration:none;}
/* Token dropdown */
.tok-dropdown{position:absolute;top:100%;right:0;z-index:50;background:#0f0f1a;
  border:1px solid var(--border);border-radius:10px;padding:8px;min-width:180px;
  box-shadow:0 20px 40px rgba(0,0,0,0.6);display:none;}
.tok-dropdown.open{display:block;}
.tok-opt{display:flex;align-items:center;gap:8px;padding:8px 10px;border-radius:7px;
  cursor:pointer;font-size:13px;font-weight:600;transition:.12s;}
.tok-opt:hover{background:rgba(255,255,255,0.06);}
.tok-pos-rel{position:relative;}
/* Swap info panel */
.swap-info{background:var(--card);border:1px solid var(--border);border-radius:16px;padding:24px;}
.si-title{font-size:15px;font-weight:800;margin-bottom:16px;}
.pool-list{display:flex;flex-direction:column;gap:8px;}
.pool-item{background:rgba(255,255,255,0.03);border:1px solid var(--border);border-radius:10px;padding:12px 14px;}
.pool-pair{font-size:13px;font-weight:700;margin-bottom:4px;}
.pool-stats{display:flex;gap:16px;flex-wrap:wrap;}
.pool-stat{font-size:11px;}
.pool-stat span{color:var(--muted);}
.pool-stat b{font-family:'Space Mono',monospace;color:var(--green);}
.apy-badge{display:inline-block;padding:2px 7px;border-radius:4px;font-size:10px;font-weight:700;
  background:rgba(0,214,143,0.12);color:var(--green);font-family:'Space Mono',monospace;}
.swap-tx{margin-top:16px;}
.tx-title{font-size:12px;color:var(--muted);font-weight:700;letter-spacing:1px;text-transform:uppercase;margin-bottom:8px;}
.tx-item{display:flex;align-items:center;gap:8px;padding:7px 0;border-bottom:1px solid rgba(255,255,255,0.04);font-size:12px;}
.tx-item:last-child{border:none;}
.tx-dot{width:7px;height:7px;border-radius:50%;background:var(--green);flex-shrink:0;}
.tx-addr{font-family:'Space Mono',monospace;color:var(--muted);font-size:11px;flex:1;}
.tx-amt{font-family:'Space Mono',monospace;font-size:11px;color:var(--btc);}
.tx-time{font-size:10px;color:var(--muted);}

/* ‚ïê‚ïê WALLET COPILOT ‚ïê‚ïê */
.copilot-grid{display:grid;grid-template-columns:1fr 1fr;gap:16px;}
.tool-card{background:var(--card);border:1px solid var(--border);border-radius:16px;padding:22px;position:relative;overflow:hidden;}
.tc-h{font-size:15px;font-weight:800;margin-bottom:3px;display:flex;align-items:center;gap:7px;}
.tc-s{font-size:12px;color:var(--muted);margin-bottom:14px;}
.inp-row{display:flex;gap:7px;}
.addr-in{flex:1;background:rgba(255,255,255,0.04);border:1px solid var(--border);
  border-radius:8px;padding:9px 12px;color:#fff;font-size:12px;outline:none;
  font-family:'Space Mono',monospace;transition:.15s;}
.addr-in:focus{border-color:var(--btc);background:rgba(247,147,26,0.04);}
.addr-in::placeholder{color:var(--muted);}
.go-btn{padding:9px 14px;background:var(--btc);color:#000;border:none;
  border-radius:8px;font-weight:800;font-size:12px;cursor:pointer;font-family:'Syne',sans-serif;transition:.15s;white-space:nowrap;}
.go-btn:hover{background:#ffab33;}
.res-box{margin-top:12px;background:rgba(0,0,0,0.35);border:1px solid var(--border);
  border-radius:8px;padding:12px;min-height:72px;font-size:12px;color:var(--muted);
  font-family:'Space Mono',monospace;line-height:1.7;white-space:pre-wrap;}
.ai-box{background:rgba(124,58,237,0.07);border:1px solid rgba(124,58,237,0.25);
  border-radius:10px;padding:12px;margin-top:10px;font-size:12px;line-height:1.6;display:none;}
.ai-tag{color:#a78bfa;font-weight:700;font-size:10px;text-transform:uppercase;letter-spacing:1px;margin-bottom:5px;}
.defi-stats{display:grid;grid-template-columns:repeat(4,1fr);gap:8px;margin-top:12px;}
.ds{background:rgba(255,255,255,0.03);border-radius:8px;padding:9px;text-align:center;}
.ds-l{font-size:9px;color:var(--muted);font-weight:700;letter-spacing:1px;text-transform:uppercase;margin-bottom:4px;}
.ds-v{font-size:14px;font-weight:800;}

/* ‚ïê‚ïê ECOSYSTEM ‚ïê‚ïê */
.eco-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(190px,1fr));gap:12px;}
.eco-card{background:var(--card2);border:1px solid var(--border);border-radius:12px;
  padding:18px;text-decoration:none;color:var(--text);transition:.2s;position:relative;overflow:hidden;display:block;}
.eco-card::after{content:'‚Üí';position:absolute;right:14px;top:50%;transform:translateY(-50%);
  color:var(--border);font-size:16px;transition:.2s;}
.eco-card:hover::after{color:var(--btc);right:10px;}
.eco-card:hover{border-color:rgba(247,147,26,0.4);transform:translateY(-3px);
  box-shadow:0 12px 32px rgba(0,0,0,0.4);}
.eco-icon{font-size:26px;margin-bottom:10px;}
.eco-nm{font-size:13px;font-weight:700;margin-bottom:3px;}
.eco-ds{font-size:11px;color:var(--muted);line-height:1.5;}
.eco-tg{display:inline-block;margin-top:8px;font-size:9px;font-weight:700;letter-spacing:1px;
  padding:2px 6px;border-radius:3px;text-transform:uppercase;}
.tg-btc{background:rgba(247,147,26,0.12);color:var(--btc);}
.tg-moto{background:rgba(124,58,237,0.15);color:#a78bfa;}
.tg-cat{background:rgba(236,72,153,0.15);color:var(--cat);}
.tg-green{background:rgba(0,214,143,0.12);color:var(--green);}
.tg-gold{background:rgba(251,191,36,0.12);color:var(--gold);}

/* ‚ïê‚ïê PINBALL GAME ‚ïê‚ïê */
.game-card{background:var(--card);border:1px solid var(--border);border-radius:16px;
  padding:24px;position:relative;overflow:hidden;}
.game-card::before{content:'';position:absolute;top:0;left:0;right:0;height:3px;
  background:linear-gradient(90deg,var(--moto),var(--cat),var(--btc),var(--green));}
.gm-title{font-family:'Bebas Neue',sans-serif;font-size:28px;letter-spacing:2px;margin-bottom:2px;}
.gm-sub{font-size:12px;color:var(--muted);margin-bottom:16px;}
.game-layout{display:grid;grid-template-columns:1fr 220px;gap:16px;align-items:start;}
#pb{display:block;border-radius:10px;border:1px solid var(--border);background:#04040e;cursor:pointer;width:100%;max-width:420px;}
.game-panel{display:flex;flex-direction:column;gap:10px;}
.gp-score{background:rgba(124,58,237,0.1);border:1px solid rgba(124,58,237,0.3);
  border-radius:10px;padding:14px;text-align:center;}
.gp-score-lbl{font-size:10px;color:#a78bfa;font-weight:700;letter-spacing:1.5px;text-transform:uppercase;margin-bottom:4px;}
.gp-score-val{font-family:'Bebas Neue',sans-serif;font-size:42px;color:#fff;line-height:1;}
.gp-best{font-size:11px;color:var(--muted);font-family:'Space Mono',monospace;}
.gp-lives{display:flex;gap:6px;justify-content:center;margin-top:6px;}
.life-cat{font-size:16px;opacity:.3;transition:.3s;}
.life-cat.alive{opacity:1;}
.gm-btn{padding:10px;border-radius:8px;font-weight:800;font-size:13px;cursor:pointer;
  font-family:'Syne',sans-serif;transition:.15s;border:none;width:100%;}
.gm-start{background:linear-gradient(135deg,var(--moto),var(--cat));color:#fff;}
.gm-start:hover{opacity:.85;}
.gm-reset{background:transparent;border:1px solid var(--border);color:var(--muted);}
.gm-reset:hover{border-color:var(--cat);color:var(--cat);}
.gm-instruct{background:rgba(0,0,0,0.3);border-radius:8px;padding:12px;}
.gm-instruct h4{font-size:11px;font-weight:700;color:var(--muted);text-transform:uppercase;letter-spacing:1px;margin-bottom:8px;}
.gm-instruct p{font-size:11px;color:var(--muted);line-height:1.6;}
.gm-instruct b{color:var(--text);}
.multiplier-bar{height:6px;border-radius:3px;background:rgba(255,255,255,0.1);overflow:hidden;margin-top:6px;}
.multiplier-fill{height:100%;background:linear-gradient(90deg,var(--btc),var(--cat));border-radius:3px;transition:.3s;}
.mult-lbl{display:flex;justify-content:space-between;font-size:10px;color:var(--muted);margin-top:3px;font-family:'Space Mono',monospace;}
/* Leaderboard */
.lb-title{font-size:11px;color:var(--muted);font-weight:700;text-transform:uppercase;letter-spacing:1px;margin-bottom:6px;}
.lb-row{display:flex;align-items:center;gap:6px;padding:5px 0;border-bottom:1px solid rgba(255,255,255,0.04);font-size:11px;}
.lb-row:last-child{border:none;}
.lb-rank{width:16px;text-align:center;font-weight:800;color:var(--muted);}
.lb-rank.g{color:var(--gold);}
.lb-rank.s{color:#c0c0c0;}
.lb-rank.b{color:#cd7f32;}
.lb-pts{font-family:'Space Mono',monospace;color:var(--cat);margin-left:auto;font-size:10px;}

/* ‚ïê‚ïê FOOTER ‚ïê‚ïê */
footer{border-top:1px solid var(--border);padding:24px 20px;max-width:1220px;margin:0 auto;
  display:flex;gap:16px;align-items:center;flex-wrap:wrap;}
.ft-logo{font-family:'Bebas Neue',sans-serif;font-size:18px;letter-spacing:2px;}
.ft-logo em{color:var(--btc);font-style:normal;}
footer p{font-size:11px;color:var(--muted);}
.ft-links{display:flex;gap:14px;margin-left:auto;flex-wrap:wrap;}
.ft-links a{font-size:11px;color:var(--muted);text-decoration:none;}
.ft-links a:hover{color:var(--btc);}
.built-badge{display:flex;align-items:center;gap:6px;background:rgba(247,147,26,0.07);
  border:1px solid rgba(247,147,26,0.2);border-radius:6px;padding:4px 10px;font-size:10px;color:var(--btc);}

/* ‚ïê‚ïê QUOTES TICKER ‚ïê‚ïê */
.quotes-ticker-wrap{background:var(--card);border:1px solid var(--border);border-radius:14px;
  padding:0;overflow:hidden;position:relative;}
.quotes-ticker-wrap::before{content:'';position:absolute;top:0;left:0;right:0;height:2px;
  background:linear-gradient(90deg,var(--moto),var(--cat),var(--btc),var(--green));}
.quotes-label{font-size:10px;font-weight:700;letter-spacing:2px;color:var(--muted);
  text-transform:uppercase;padding:12px 20px 8px;border-bottom:1px solid var(--border);}
.quotes-track-outer{overflow:hidden;padding:16px 0;position:relative;}
.quotes-track-outer::before,.quotes-track-outer::after{content:'';position:absolute;top:0;bottom:0;width:80px;z-index:2;pointer-events:none;}
.quotes-track-outer::before{left:0;background:linear-gradient(90deg,var(--card),transparent);}
.quotes-track-outer::after{right:0;background:linear-gradient(270deg,var(--card),transparent);}
.quotes-track{display:flex;gap:0;width:max-content;animation:quotesScroll 55s linear infinite;}
.quotes-track:hover{animation-play-state:paused;}
@keyframes quotesScroll{from{transform:translateX(0)}to{transform:translateX(-50%)}}
.quote-card{display:flex;flex-direction:column;gap:6px;padding:10px 24px;min-width:320px;max-width:380px;
  border-right:1px solid var(--border);flex-shrink:0;}
.quote-text{font-size:13px;line-height:1.55;color:var(--text);font-style:italic;}
.quote-text::before{content:'"';color:var(--btc);font-size:18px;font-style:normal;margin-right:2px;}
.quote-text::after{content:'"';color:var(--btc);font-size:18px;font-style:normal;margin-left:2px;}
.quote-author{font-size:11px;color:var(--muted);font-weight:700;display:flex;align-items:center;gap:6px;}
.quote-author em{font-style:normal;color:var(--moto);}

/* ‚ïê‚ïê TOAST ‚ïê‚ïê */
#toast{position:fixed;bottom:24px;right:24px;z-index:999;
  background:var(--card);border:1px solid var(--border);border-radius:10px;
  padding:12px 18px;font-size:13px;font-weight:600;opacity:0;
  transform:translateY(16px);transition:.3s;pointer-events:none;max-width:300px;}
#toast.show{opacity:1;transform:translateY(0);}
#toast.success{border-color:rgba(0,214,143,0.4);color:var(--green);}
#toast.error{border-color:rgba(255,61,90,0.4);color:var(--red);}
#toast.info{border-color:rgba(124,58,237,0.4);color:#a78bfa;}

/* ‚ïê‚ïê RESPONSIVE ‚ïê‚ïê */
@media(max-width:900px){
  .hero{grid-template-columns:1fr;gap:24px;}
  .swap-grid{grid-template-columns:1fr;}
  .copilot-grid{grid-template-columns:1fr;}
  .game-layout{grid-template-columns:1fr;}
  nav{display:none;}
  .comp-features{display:none;}
}
@media(max-width:600px){
  .pill-moto{display:none;}
  .stats-grid{grid-template-columns:1fr 1fr;}
  .defi-stats{grid-template-columns:repeat(2,1fr);}
}
</style>
</head>
<body>

<!-- TOPBAR -->
<header class="topbar">
  <div class="logo">OP<em>_</em>NET</div>
  <div class="pill pill-btc">‚Çø <span id="tpBtc">‚Äî</span> <span class="chg" id="tpBtcC">‚Äî</span></div>
  <nav>
    <a href="#swap">Swap</a>
    <a href="#copilot">Copilot</a>
    <a href="#ecosystem">Ecosystem</a>
    <a href="#game">Game</a>
    <a href="https://defibible.opnet.org" target="_blank" style="color:var(--btc)">DeFiBible ‚Üó</a>
  </nav>
  <button class="conn-btn" onclick="connectWallet()">‚ö° Connect Wallet</button>
</header>

<div class="pg">
<!-- HERO -->
<div class="hero wrap" id="hero">
  <div>
    <h1 class="hero-h1">BITCOIN<br><em class="hero-defi">DEFI</em><br>HUB</h1>
    <p class="hero-sub">The most complete OP_NET dashboard ‚Äî live BTC price, one-click swaps, wallet AI, MotoCat pinball, block miner and the full Bitcoin L1 DeFi ecosystem.</p>
    <div class="hero-btns">
      <a href="#swap" class="btn-o btn-solid">üîÑ Swap Tokens</a>
      <a href="#ecosystem" class="btn-o btn-ghost">üåê Ecosystem</a>
      <a href="#game" class="btn-o btn-pink">üê± Play Games</a>
    </div>
  </div>
  <div class="stats-grid">
    <div class="sc">
      <div class="sc-lbl">BTC Price</div>
      <div class="sc-val" id="hBtc">‚Äî</div>
      <div class="sc-sub" id="hBtcC">Loading...</div>
    </div>
    <div class="sc">
      <div class="sc-lbl">Network Status</div>
      <div class="sc-val" style="color:var(--green);font-size:14px">‚óè LIVE</div>
      <div class="sc-sub">OP_NET Mainnet</div>
    </div>
    <div class="sc">
      <div class="sc-lbl">Total Swaps</div>
      <div class="sc-val">325k+</div>
      <div class="sc-sub">MotoSwap testnet</div>
    </div>
    <div class="sc">
      <div class="sc-lbl">MOTO Staked</div>
      <div class="sc-val">296M</div>
      <div class="sc-sub up">+13.8k tBTC staked</div>
    </div>
  </div>
</div>

<!-- SWAP WIDGET -->
<div class="swap-section" id="swap">
  <div class="wrap" style="padding:0;margin-bottom:18px;">
    <div class="sec-title">üîÑ MotoSwap ‚Äî OP_NET DEX</div>
  </div>
  <div class="swap-grid">
    <div class="swap-card">
      <div class="sw-title">Token Swap</div>
      <div class="sw-sub">Swap OP_20 tokens on Bitcoin L1 via MotoSwap</div>
      <!-- FROM -->
      <div class="sw-box">
        <div class="sw-row">
          <div class="sw-label">From</div>
          <span class="sw-max" onclick="setMax('from')">MAX</span>
        </div>
        <div class="sw-inner">
          <input class="sw-input" id="swFromAmt" type="number" placeholder="0.0" oninput="calcSwap()">
          <div class="tok-pos-rel">
            <button class="tok-btn" id="fromTokBtn" onclick="toggleDropdown('from')">
              <span class="tok-dot tok-rbtc">‚Çø</span>
              <span id="fromTokName">rBTC</span> ‚ñæ
            </button>
            <div class="tok-dropdown" id="fromDrop">
              <div class="tok-opt" onclick="selectToken('from','rBTC','‚Çø','tok-rbtc')"><span class="tok-dot tok-rbtc">‚Çø</span>rBTC (Regtest BTC)</div>
              <div class="tok-opt" onclick="selectToken('from','MOTO','üõµ','tok-moto')"><span class="tok-dot tok-moto">M</span>MOTO (MotoSwap)</div>
              <div class="tok-opt" onclick="selectToken('from','PILL','üíä','tok-pill')"><span class="tok-dot tok-pill">P</span>PILL</div>
              <div class="tok-opt" onclick="selectToken('from','WBTC','‚Çø','tok-btc')"><span class="tok-dot tok-btc">W</span>WBTC</div>
            </div>
          </div>
        </div>
        <div style="font-size:11px;color:var(--muted);margin-top:6px;font-family:'Space Mono',monospace;">
          Balance: <span id="fromBal">‚Äî</span>
        </div>
      </div>
      <!-- ARROW -->
      <div class="sw-arrow-row"><div class="sw-arrow" onclick="flipTokens()">‚áÖ</div></div>
      <!-- TO -->
      <div class="sw-box">
        <div class="sw-row">
          <div class="sw-label">To (estimated)</div>
          <span class="sw-max" style="color:var(--muted);">slippage: <span id="slippageVal">0.5%</span></span>
        </div>
        <div class="sw-inner">
          <input class="sw-input" id="swToAmt" type="number" placeholder="0.0" readonly style="opacity:.7;">
          <div class="tok-pos-rel">
            <button class="tok-btn" id="toTokBtn" onclick="toggleDropdown('to')">
              <span class="tok-dot tok-moto">M</span>
              <span id="toTokName">MOTO</span> ‚ñæ
            </button>
            <div class="tok-dropdown" id="toDrop">
              <div class="tok-opt" onclick="selectToken('to','rBTC','‚Çø','tok-rbtc')"><span class="tok-dot tok-rbtc">‚Çø</span>rBTC</div>
              <div class="tok-opt" onclick="selectToken('to','MOTO','üõµ','tok-moto')"><span class="tok-dot tok-moto">M</span>MOTO</div>
              <div class="tok-opt" onclick="selectToken('to','PILL','üíä','tok-pill')"><span class="tok-dot tok-pill">P</span>PILL</div>
              <div class="tok-opt" onclick="selectToken('to','WBTC','‚Çø','tok-btc')"><span class="tok-dot tok-btc">W</span>WBTC</div>
            </div>
          </div>
        </div>
        <div style="font-size:11px;color:var(--muted);margin-top:6px;font-family:'Space Mono',monospace;">
          Balance: <span id="toBal">‚Äî</span>
        </div>
      </div>
      <div class="sw-rate" id="swRate">Enter amount to see rate</div>
      <div class="sw-details" id="swDetails" style="display:none">
        <div class="sw-detail-row"><span>Exchange Rate</span><b id="swRateB">‚Äî</b></div>
        <div class="sw-detail-row"><span>Price Impact</span><b id="swImpact" style="color:var(--green)">‚Äî</b></div>
        <div class="sw-detail-row"><span>Liquidity Fee (0.3%)</span><b id="swFee">‚Äî</b></div>
        <div class="sw-detail-row"><span>Min Received</span><b id="swMin">‚Äî</b></div>
        <div class="sw-detail-row"><span>Route</span><b id="swRoute" style="color:var(--moto)">‚Äî</b></div>
      </div>
      <button class="sw-btn" id="swapBtn" onclick="executeSwap()">Connect Wallet to Swap</button>
      <div class="sw-notice">Powered by <a href="https://motoswap.org" target="_blank">MotoSwap</a> on OP_NET ¬∑ <a href="https://opnet.org" target="_blank">Bitcoin L1</a></div>
    </div>
    <div class="swap-info">
      <div class="si-title">üìä Pool Overview</div>
      <div class="pool-list">
        <div class="pool-item">
          <div class="pool-pair" style="display:flex;align-items:center;gap:8px;">
            rBTC / MOTO
            <span class="apy-badge">38.2% APY</span>
          </div>
          <div class="pool-stats">
            <div class="pool-stat"><span>TVL</span><b>$2.1M</b></div>
            <div class="pool-stat"><span>Vol 24h</span><b>$84k</b></div>
            <div class="pool-stat"><span>Fees</span><b>0.3%</b></div>
          </div>
        </div>
        <div class="pool-item">
          <div class="pool-pair" style="display:flex;align-items:center;gap:8px;">
            PILL / MOTO
            <span class="apy-badge">52.7% APY</span>
          </div>
          <div class="pool-stats">
            <div class="pool-stat"><span>TVL</span><b>$890k</b></div>
            <div class="pool-stat"><span>Vol 24h</span><b>$31k</b></div>
            <div class="pool-stat"><span>Fees</span><b>0.3%</b></div>
          </div>
        </div>
        <div class="pool-item">
          <div class="pool-pair" style="display:flex;align-items:center;gap:8px;">
            WBTC / rBTC
            <span class="apy-badge">12.4% APY</span>
          </div>
          <div class="pool-stats">
            <div class="pool-stat"><span>TVL</span><b>$5.4M</b></div>
            <div class="pool-stat"><span>Vol 24h</span><b>$220k</b></div>
            <div class="pool-stat"><span>Fees</span><b>0.05%</b></div>
          </div>
        </div>
      </div>
      <div class="swap-tx">
        <div class="tx-title">Recent Swaps</div>
        <div id="recentTxs">
          <div class="tx-item"><div class="tx-dot"></div><div class="tx-addr">bcrt1p...8f3a</div><div class="tx-amt">+420 MOTO</div><div class="tx-time">12s ago</div></div>
          <div class="tx-item"><div class="tx-dot"></div><div class="tx-addr">bcrt1q...2c9e</div><div class="tx-amt">0.012 rBTC</div><div class="tx-time">34s ago</div></div>
          <div class="tx-item"><div class="tx-dot" style="background:var(--moto)"></div><div class="tx-addr">bcrt1p...7d11</div><div class="tx-amt">+1,200 PILL</div><div class="tx-time">1m ago</div></div>
          <div class="tx-item"><div class="tx-dot"></div><div class="tx-addr">bcrt1q...aa02</div><div class="tx-amt">0.005 rBTC</div><div class="tx-time">2m ago</div></div>
          <div class="tx-item"><div class="tx-dot" style="background:var(--cat)"></div><div class="tx-addr">bcrt1p...3f88</div><div class="tx-amt">+890 MOTO</div><div class="tx-time">3m ago</div></div>
        </div>
      </div>
      <div style="margin-top:16px;">
        <a href="https://motoswap.org" target="_blank" class="btn-o btn-ghost" style="font-size:12px;padding:8px 16px;width:100%;justify-content:center;">
          Open Full MotoSwap DEX ‚Üí
        </a>
      </div>
    </div>
  </div>
</div>

<!-- WALLET COPILOT -->
<div class="wrap" style="padding-top:32px;padding-bottom:18px;" id="copilot">
  <div class="sec-title">ü§ñ AI Wallet Copilot</div>
  <div class="copilot-grid">
    <div class="tool-card">
      <div class="tc-h">üîç Address Analyzer</div>
      <div class="tc-s">Inspect rBTC, OP_20 tokens, and transaction history</div>
      <div class="inp-row">
        <input class="addr-in" id="anaAddr" placeholder="bcrt1p... or type 'demo'">
        <button class="go-btn" onclick="analyzeAddr()">Analyze ‚Üí</button>
      </div>
      <div class="res-box" id="anaRes"><span style="color:var(--muted)">Enter any OP_NET address to analyze. Type "demo" for a sample.</span></div>
      <div class="ai-box" id="anaAI"><div class="ai-tag">ü§ñ AI Copilot Insight</div><div id="anaAITxt"></div></div>
    </div>
    <div class="tool-card">
      <div class="tc-h">üìä DeFi Positions</div>
      <div class="tc-s">View liquidity pools, staking and yield estimates</div>
      <div class="inp-row">
        <input class="addr-in" id="defiAddr" placeholder="bcrt1p... or type 'demo'">
        <button class="go-btn" onclick="loadDefi()">Load ‚Üí</button>
      </div>
      <div class="res-box" id="defiRes"><span style="color:var(--muted)">Enter address to see DeFi positions on OP_NET.</span></div>
      <div class="defi-stats">
        <div class="ds"><div class="ds-l">Wallet</div><div class="ds-v" id="dsW">‚Äî</div></div>
        <div class="ds"><div class="ds-l">In DeFi</div><div class="ds-v" id="dsD">‚Äî</div></div>
        <div class="ds"><div class="ds-l">Positions</div><div class="ds-v" id="dsP">‚Äî</div></div>
        <div class="ds"><div class="ds-l">Daily Est.</div><div class="ds-v" id="dsY" style="color:var(--green)">‚Äî</div></div>
      </div>
    </div>
  </div>
</div>

<!-- ECOSYSTEM -->
<div class="wrap" style="padding-top:32px;padding-bottom:18px;" id="ecosystem">
  <div class="sec-title">üåê OP_NET Ecosystem</div>
  <div class="eco-grid">
    <a href="https://motoswap.org" target="_blank" class="eco-card">
      <div class="eco-icon">üõµ</div><div class="eco-nm">MotoSwap DEX</div>
      <div class="eco-ds">First Bitcoin L1 DEX. Swap, LP, stake $MOTO ‚Äî fully self-custodial.</div>
      <span class="eco-tg tg-moto">DEX ¬∑ AMM</span>
    </a>
    <a href="https://garage.motoswap.org" target="_blank" class="eco-card">
      <div class="eco-icon">üê±</div><div class="eco-nm">MotoCats Garage</div>
      <div class="eco-ds">10,000 Bitcoin-native NFTs. Stake MotoCats, earn real yield.</div>
      <span class="eco-tg tg-cat">NFT ¬∑ OP_721</span>
    </a>
    <a href="https://motoswap.org/stake" target="_blank" class="eco-card">
      <div class="eco-icon">üè¶</div><div class="eco-nm">MotoChef Farm</div>
      <div class="eco-ds">Stake LP tokens, earn $MOTO farming rewards with MotoChef.</div>
      <span class="eco-tg tg-moto">Yield ¬∑ Farm</span>
    </a>
    <a href="https://faucet.opnet.org" target="_blank" class="eco-card">
      <div class="eco-icon">üö∞</div><div class="eco-nm">rBTC Faucet</div>
      <div class="eco-ds">Free regtest BTC to start exploring OP_NET DeFi protocols.</div>
      <span class="eco-tg tg-btc">Testnet</span>
    </a>
    <a href="https://opnet.org" target="_blank" class="eco-card">
      <div class="eco-icon">üåê</div><div class="eco-nm">OP_NET Portal</div>
      <div class="eco-ds">Main hub. Earn points, complete on-chain tasks, climb the leaderboard.</div>
      <span class="eco-tg tg-gold">Points ¬∑ Airdrop</span>
    </a>
    <a href="https://docs.opnet.org" target="_blank" class="eco-card">
      <div class="eco-icon">üìñ</div><div class="eco-nm">Developer Docs</div>
      <div class="eco-ds">Build OP_20 tokens &amp; OP_721 NFTs with AssemblyScript on Bitcoin.</div>
      <span class="eco-tg tg-btc">Dev ¬∑ SDK</span>
    </a>
    <a href="https://chromewebstore.google.com/detail/opwallet/pmbjpcmaaladnfpacpmhmnfmpklgbdjb" target="_blank" class="eco-card">
      <div class="eco-icon">üîê</div><div class="eco-nm">OP_WALLET</div>
      <div class="eco-ds">Official Chrome wallet for OP_NET. Self-custodial, Bitcoin-native.</div>
      <span class="eco-tg tg-btc">Wallet</span>
    </a>
    <a href="https://opnet.org/points" target="_blank" class="eco-card">
      <div class="eco-icon">üèÜ</div><div class="eco-nm">Airdrop Points</div>
      <div class="eco-ds">Complete tasks every 48h to earn points toward the mainnet airdrop.</div>
      <span class="eco-tg tg-gold">Airdrop</span>
    </a>
    <a href="https://defibible.opnet.org" target="_blank" class="eco-card">
      <div class="eco-icon">üìú</div><div class="eco-nm">DeFiBible</div>
      <div class="eco-ds">The complete knowledge base for Bitcoin DeFi on OP_NET. Learn, build and understand the ecosystem.</div>
      <span class="eco-tg tg-btc">Knowledge</span>
    </a>
  </div>
</div>

<!-- PINBALL GAME -->
<div class="wrap" style="padding-top:32px;padding-bottom:32px;" id="game">
  <div class="sec-title">üéÆ MotoCat Pinball ‚Äî OP_NET Edition</div>
  <div class="game-card">
    <div class="gm-title">üê± MOTOCAT PINBALL</div>
    <div class="gm-sub">Launch the MotoCat ball! Hit bumpers to collect $MOTO, PILL & rBTC. Use flippers to survive the blockchain!</div>
    <div class="game-layout">
      <canvas id="pb" height="520"></canvas>
      <div class="game-panel">
        <div class="gp-score">
          <div class="gp-score-lbl">Score</div>
          <div class="gp-score-val" id="pbScore">0</div>
          <div class="gp-best">Best: <span id="pbBest">0</span></div>
          <div class="gp-lives">
            <span class="life-cat alive" id="life0">üê±</span>
            <span class="life-cat alive" id="life1">üê±</span>
            <span class="life-cat alive" id="life2">üê±</span>
          </div>
        </div>
        <div>
          <div class="multiplier-bar"><div class="multiplier-fill" id="multFill" style="width:0%"></div></div>
          <div class="mult-lbl"><span>Multiplier</span><span id="multVal">x1</span></div>
        </div>
        <button class="gm-btn gm-start" id="pbStartBtn" onclick="pbStart()">‚ñ∂ Launch Cat!</button>
        <button class="gm-btn gm-reset" onclick="pbReset()">‚Ü© Reset</button>
        <div class="gm-instruct">
          <h4>üéÆ Controls</h4>
          <p><b>Z / ‚Üê</b> = Left flipper<br><b>/ / ‚Üí</b> = Right flipper<br><b>Space</b> = Launch ball<br><b>Tap sides</b> on mobile</p>
          <br>
          <h4>ü™ô Targets</h4>
          <p><span style="color:var(--btc)">‚Çø</span> rBTC = 500 pts<br>
          <span style="color:#a78bfa">M</span> MOTO = 200 pts<br>
          <span style="color:var(--green)">P</span> PILL = 100 pts<br>
          <span style="color:var(--cat)">üê±</span> Cat = 1000 pts!</p>
        </div>
        <div>
          <div class="lb-title">üèÜ High Scores</div>
          <div id="pbLb"></div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- MOTOCAT RIDER (global overlay) -->
<canvas id="motoRider" width="140" height="70"></canvas>

<!-- BTC BLOCK MINER GAME -->
<div class="wrap" style="padding-top:16px;padding-bottom:32px;">
  <div class="sec-title">‚õèÔ∏è BTC Block Miner</div>
  <div class="miner-card">
    <div class="miner-title">‚õèÔ∏è BTC BLOCK MINER</div>
    <div class="miner-sub">Click/tap to smash blocks and mine $MOTO. Upgrade your rig to mine faster. Race the clock!</div>
    <div class="miner-layout">
      <canvas id="minerCanvas" height="400"></canvas>
      <div class="miner-panel">
        <div class="mp-stat">
          <div class="mp-stat-lbl">$MOTO Mined</div>
          <div class="mp-stat-val" id="mMined">0</div>
        </div>
        <div class="mp-stat" style="background:rgba(0,214,143,0.07);border-color:rgba(0,214,143,0.2);">
          <div class="mp-stat-lbl" style="color:var(--green)">Hash Rate</div>
          <div class="mp-stat-val" id="mHash" style="font-size:22px;color:var(--green)">1 H/s</div>
          <div class="hashbar"><div class="hashfill" id="hashFill" style="width:0%"></div></div>
        </div>
        <div class="mp-stat" style="background:rgba(124,58,237,0.07);border-color:rgba(124,58,237,0.2);">
          <div class="mp-stat-lbl" style="color:#a78bfa">Blocks Found</div>
          <div class="mp-stat-val" id="mBlocks" style="color:#a78bfa">0</div>
        </div>
        <div class="mp-upgrade">
          <h4>‚ö° Upgrades</h4>
          <button class="upgrade-btn" id="upg0" onclick="buyUpgrade(0)">
            <span>üñ•Ô∏è GPU Rig</span><span class="ub-cost" id="upg0cost">50 MOTO</span>
          </button>
          <button class="upgrade-btn" id="upg1" onclick="buyUpgrade(1)">
            <span>‚ö° ASIC Miner</span><span class="ub-cost" id="upg1cost">200 MOTO</span>
          </button>
          <button class="upgrade-btn" id="upg2" onclick="buyUpgrade(2)">
            <span>üè≠ Mining Farm</span><span class="ub-cost" id="upg2cost">1000 MOTO</span>
          </button>
          <button class="upgrade-btn" id="upg3" onclick="buyUpgrade(3)">
            <span>üõ∞Ô∏è Satellite Rig</span><span class="ub-cost" id="upg3cost">5000 MOTO</span>
          </button>
        </div>
        <button class="gm-btn gm-reset" style="width:100%" onclick="resetMiner()">‚Ü© Reset Miner</button>
      </div>
    </div>
  </div>
</div>

<!-- QUOTES TICKER -->
<div class="wrap" style="padding-bottom:32px;">
  <div class="quotes-ticker-wrap">
    <div class="quotes-label">üí¨ FROM THE COMMUNITY</div>
    <div class="quotes-track-outer">
      <div class="quotes-track" id="quoteTrack"></div>
    </div>
  </div>
</div>

</div><!-- end .pg -->

<footer class="wrap">
  <div class="ft-logo">OP<em>_</em>NET</div>
  <p>Bitcoin Layer 1 DeFi ¬∑ MotoSwap ¬∑ MotoCats ¬∑ OP_20 Smart Contracts</p>
  <div class="ft-links">
    <a href="https://opnet.org" target="_blank">Portal</a>
    <a href="https://motoswap.org" target="_blank">MotoSwap</a>
    <a href="https://garage.motoswap.org" target="_blank">MotoCats</a>
    <a href="https://docs.opnet.org" target="_blank">Docs</a>
    <a href="https://faucet.opnet.org" target="_blank">Faucet</a>
  </div>
  <div class="built-badge">‚ö° Built on OP_NET</div>
</footer>

<div id="toast"></div>

<script>
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// TOAST
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function toast(msg, type='info', dur=3000) {
  const t = document.getElementById('toast');
  t.textContent = msg; t.className = 'show ' + type;
  clearTimeout(t._t);
  t._t = setTimeout(() => t.className = '', dur);
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// PRICE DATA
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
let btcData = {};

async function fetchPrices() {
  try {
    const r = await fetch('https://api.coingecko.com/api/v3/simple/price?ids=bitcoin&vs_currencies=usd&include_24hr_change=true&include_24hr_vol=true&include_market_cap=true&include_high_24h=true&include_low_24h=true');
    const d = await r.json();
    btcData = d.bitcoin || {};
    updatePriceUI();
  } catch(e) { console.warn('Price fetch failed', e); }
}

function fmt(n, d=0) { return n ? n.toLocaleString('en-US',{maximumFractionDigits:d}) : '‚Äî'; }
function fmtUsd(n) { return n ? '$'+fmt(n) : '‚Äî'; }

function updatePriceUI() {
  const bp = btcData.usd, bc = btcData.usd_24h_change;
  if(!bp) return;
  const bup = bc >= 0;
  const tpBtc = document.getElementById('tpBtc');
  if(tpBtc) tpBtc.textContent = '$'+fmt(bp);
  const tpBtcC = document.getElementById('tpBtcC');
  if(tpBtcC) { tpBtcC.textContent = (bup?'+':'')+bc?.toFixed(2)+'%'; tpBtcC.className = 'chg '+(bup?'up':'dn'); }
  const hBtc = document.getElementById('hBtc');
  if(hBtc) hBtc.textContent = '$'+Math.round(bp/1000)+'k';
  const hBtcC = document.getElementById('hBtcC');
  if(hBtcC) { hBtcC.textContent = (bup?'‚ñ≤':'‚ñº')+' '+(bup?'+':'')+bc?.toFixed(2)+'% 24h'; hBtcC.className = 'sc-sub '+(bup?'up':'dn'); }
}


// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// WALLET
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
let walletConnected = false;

function connectWallet() {
  if(!walletConnected) {
    walletConnected = true;
    const btn = document.querySelector('.conn-btn');
    btn.textContent = '‚úì Connected';
    btn.style.background = 'rgba(0,214,143,0.2)';
    btn.style.color = '#00d68f';
    btn.style.border = '1px solid rgba(0,214,143,0.4)';
    const fromBal = document.getElementById('fromBal');
    if(fromBal) fromBal.textContent = '0.042 rBTC';
    const toBal = document.getElementById('toBal');
    if(toBal) toBal.textContent = '12,400 MOTO';
    const swapBtn = document.getElementById('swapBtn');
    if(swapBtn) { swapBtn.textContent = 'Swap Tokens'; swapBtn.disabled = false; }
    toast('‚úì Wallet connected! (demo mode)', 'success');
  } else {
    walletConnected = false;
    const btn = document.querySelector('.conn-btn');
    btn.textContent = '‚ö° Connect Wallet'; btn.style.cssText = '';
    const fromBal = document.getElementById('fromBal'); if(fromBal) fromBal.textContent = '‚Äî';
    const toBal = document.getElementById('toBal'); if(toBal) toBal.textContent = '‚Äî';
    const swapBtn = document.getElementById('swapBtn');
    if(swapBtn) { swapBtn.textContent = 'Connect Wallet to Swap'; }
    toast('Wallet disconnected', 'error');
  }
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// SWAP WIDGET
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
let fromTok = 'rBTC', toTok = 'MOTO';
const RATES = { 'rBTC-MOTO':14200, 'rBTC-PILL':38000, 'rBTC-WBTC':0.99, 'MOTO-rBTC':1/14200, 'MOTO-PILL':2.67, 'PILL-MOTO':0.375, 'PILL-rBTC':1/38000, 'WBTC-rBTC':1.01, 'MOTO-WBTC':1/14000, 'WBTC-MOTO':14100 };

function getRate(from, to) {
  if(from===to) return 1;
  return RATES[from+'-'+to] || (RATES[to+'-'+from] ? 1/RATES[to+'-'+from] : 1);
}

function calcSwap() {
  const amt = parseFloat(document.getElementById('swFromAmt').value)||0;
  if(!amt) {
    document.getElementById('swToAmt').value='';
    document.getElementById('swRate').textContent='Enter amount to see rate';
    document.getElementById('swDetails').style.display='none';
    return;
  }
  const rate = getRate(fromTok, toTok);
  const out = amt * rate * 0.997;
  document.getElementById('swToAmt').value = out < 0.001 ? out.toFixed(6) : out.toFixed(4);
  const impact = amt > 1 ? 0.82 : 0.12;
  document.getElementById('swRate').innerHTML = '<b>1 '+fromTok+' ‚âà '+(rate<0.001?rate.toFixed(6):rate.toFixed(4))+' '+toTok+'</b>';
  document.getElementById('swDetails').style.display='block';
  document.getElementById('swRateB').textContent = '1 '+fromTok+' = '+(rate<0.001?rate.toFixed(6):rate.toFixed(4))+' '+toTok;
  document.getElementById('swImpact').textContent = impact+'%';
  document.getElementById('swImpact').style.color = impact > 1 ? '#ff3d5a' : '#00d68f';
  document.getElementById('swFee').textContent = (amt*0.003).toFixed(6)+' '+fromTok;
  document.getElementById('swMin').textContent = (out*0.995).toFixed(4)+' '+toTok;
  document.getElementById('swRoute').textContent = fromTok+' ‚Üí MotoSwap ‚Üí '+toTok;
}

function toggleDropdown(side) {
  const d = document.getElementById(side==='from'?'fromDrop':'toDrop');
  const other = document.getElementById(side==='from'?'toDrop':'fromDrop');
  other.classList.remove('open'); d.classList.toggle('open');
}

function selectToken(side, tok, icon, dotClass) {
  const btn = document.getElementById(side==='from'?'fromTokBtn':'toTokBtn');
  const nameEl = document.getElementById(side==='from'?'fromTokName':'toTokName');
  const dot = btn.querySelector('.tok-dot');
  dot.className = 'tok-dot '+dotClass; dot.textContent = icon;
  nameEl.textContent = tok;
  document.getElementById(side==='from'?'fromDrop':'toDrop').classList.remove('open');
  if(side==='from') fromTok=tok; else toTok=tok;
  calcSwap();
}

function setMax() {
  if(!walletConnected) { toast('Connect wallet first!', 'error'); return; }
  document.getElementById('swFromAmt').value = '0.042'; calcSwap();
}

function flipTokens() {
  const fN=document.getElementById('fromTokName').textContent;
  const tN=document.getElementById('toTokName').textContent;
  const fD=document.getElementById('fromTokBtn').querySelector('.tok-dot');
  const tD=document.getElementById('toTokBtn').querySelector('.tok-dot');
  const tmpC=fD.className, tmpT=fD.textContent;
  fD.className=tD.className; fD.textContent=tD.textContent;
  tD.className=tmpC; tD.textContent=tmpT;
  document.getElementById('fromTokName').textContent=tN;
  document.getElementById('toTokName').textContent=fN;
  fromTok=tN; toTok=fN;
  document.getElementById('swFromAmt').value=document.getElementById('swToAmt').value;
  calcSwap();
}

function executeSwap() {
  if(!walletConnected) { connectWallet(); return; }
  const amt = document.getElementById('swFromAmt').value;
  if(!amt||parseFloat(amt)<=0) { toast('Enter an amount first', 'error'); return; }
  const btn = document.getElementById('swapBtn');
  btn.textContent='Swapping...'; btn.classList.add('loading'); btn.disabled=true;
  setTimeout(()=>{
    btn.textContent='Swap Tokens'; btn.classList.remove('loading'); btn.disabled=false;
    toast('‚úì Swapped '+amt+' '+fromTok+' ‚Üí '+document.getElementById('swToAmt').value+' '+toTok, 'success', 4000);
    addFakeTx(fromTok, toTok, amt);
  }, 1800);
}

function addFakeTx(from, to, amt) {
  const txs = document.getElementById('recentTxs');
  if(!txs) return;
  const div = document.createElement('div');
  div.className='tx-item';
  div.innerHTML='<div class="tx-dot" style="background:#ec4899"></div><div class="tx-addr">bcrt1p...you</div><div class="tx-amt">'+amt+' '+from+'‚Üí'+to+'</div><div class="tx-time">just now</div>';
  txs.insertBefore(div, txs.firstChild);
  if(txs.children.length>6) txs.removeChild(txs.lastChild);
}

document.addEventListener('click', e => {
  if(!e.target.closest('.tok-pos-rel'))
    document.querySelectorAll('.tok-dropdown').forEach(d=>d.classList.remove('open'));
});

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// WALLET COPILOT
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function analyzeAddr() {
  const addr = document.getElementById('anaAddr').value.trim();
  const res = document.getElementById('anaRes');
  const ai = document.getElementById('anaAI');
  if(!addr) { res.innerHTML='<span style="color:#ff3d5a">Please enter an address.</span>'; return; }
  res.innerHTML='<span style="color:#f7931a">‚ü≥ Querying OP_NET...</span>';
  ai.style.display='none';
  setTimeout(()=>{
    const a = addr==='demo' ? 'bcrt1p...demo1234' : addr;
    res.innerHTML='Address: <span style="color:#f7931a">'+a.slice(0,14)+'...'+a.slice(-6)+'</span>\n\nrBTC Balance:  <span style="color:#fff">0.00842 rBTC</span>\n\nOP_20 Tokens:\n  MOTO  <span style="color:#a78bfa">12,400.00</span>\n  PILL  <span style="color:#00d68f">3,200.50</span>\n  CATS  <span style="color:#ec4899">1 NFT</span>\n\nTransactions (last 7):\n  ‚úì Swap rBTC‚ÜíMOTO    <span style="color:#00d68f">confirmed</span>\n  ‚úì Add LP rBTC/MOTO  <span style="color:#00d68f">confirmed</span>\n  ‚úì Stake MOTO        <span style="color:#00d68f">confirmed</span>\n  ‚úì Claim PILL reward <span style="color:#00d68f">confirmed</span>';
    ai.style.display='block';
    document.getElementById('anaAITxt').innerHTML='This wallet is <b>deeply embedded in the MotoSwap ecosystem</b> üõµ ‚Äî holding MOTO, PILL and a MotoCat NFT. The LP position in rBTC/MOTO is earning an estimated <b>38.2% APY</b>. Recommend checking <a href="https://motoswap.org/pools" style="color:#7c3aed">MotoSwap pools</a> to compound rewards.';
  }, 1100);
}

function loadDefi() {
  const addr = document.getElementById('defiAddr').value.trim();
  const res = document.getElementById('defiRes');
  if(!addr) { res.innerHTML='<span style="color:#ff3d5a">Please enter an address.</span>'; return; }
  res.innerHTML='<span style="color:#7c3aed">‚ü≥ Loading DeFi positions...</span>';
  setTimeout(()=>{
    res.innerHTML='MotoSwap LP  rBTC/MOTO\n  Deposited: <span style="color:#00d68f">$840 USD</span>  APY: <span style="color:#f7931a">38.2%</span>\n\nMotoChef Farm  PILL-MOTO LP\n  Staked: <span style="color:#00d68f">$380 USD</span>  Daily: <span style="color:#00d68f">+0.82 MOTO</span>\n\nMotoCat Staking\n  1 NFT staked  Earning: <span style="color:#ec4899">real yield</span>';
    const dsW=document.getElementById('dsW'); if(dsW) dsW.textContent='$480';
    const dsD=document.getElementById('dsD'); if(dsD) dsD.textContent='$1,220';
    const dsP=document.getElementById('dsP'); if(dsP) dsP.textContent='3';
    const dsY=document.getElementById('dsY'); if(dsY) dsY.textContent='+$4.2/d';
  }, 1000);
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// PINBALL ‚Äî PONG PADDLE BUMPERS
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
const pbCanvas = document.getElementById('pb');
const gc = pbCanvas.getContext('2d');
let PBW = 380, PBH = 520;
let pbState = 'idle';
let pbScore = 0;
let pbBest = parseInt(localStorage.getItem('pbBest')||'0');
let pbRaf = null;
let pbLives = 3, pbMult = 1, pbMultTimer = 0;
let leftFlip = false, rightFlip = false;
let ballLaunched = false;
let pbLB = [];
try { pbLB = JSON.parse(localStorage.getItem('pbLB')||'[]'); } catch(e){}

let pbBall = {x:190, y:390, vx:2.5, vy:-9, r:9};
let pbFlippers = {lx:176, ly:460, lw:60, rx:204, ry:460, rw:60};
let pbPaddles = [];
let pbTargets = [];

function resizePB() {
  PBW = pbCanvas.offsetWidth || 380;
  PBH = 520;
  pbCanvas.width = PBW;
  pbCanvas.height = PBH;
}

function pbInit() {
  resizePB();
  const cx = PBW/2;
  pbBall = {x:cx, y:PBH-130, vx:2.5, vy:-9, r:9};
  pbFlippers = {lx:cx-14, ly:PBH-60, lw:60, rx:cx+14, ry:PBH-60, rw:60};
  pbPaddles = [
    {x:cx-36, y:90,  w:72, h:14, vx:1.8,  vy:0,   col:'#f7931a', lbl:'‚Çø rBTC', pts:500,  flash:0, axis:'h', minX:25,       maxX:PBW-97},
    {x:28,    y:200, w:14, h:60, vx:0,    vy:1.5,  col:'#7c3aed', lbl:'M',      pts:200,  flash:0, axis:'v', minY:160,      maxY:300},
    {x:PBW-42,y:240, w:14, h:60, vx:0,    vy:-1.5, col:'#10b981', lbl:'P',      pts:100,  flash:0, axis:'v', minY:160,      maxY:300},
    {x:cx-44, y:310, w:88, h:14, vx:-2.2, vy:0,    col:'#ec4899', lbl:'üê± CAT', pts:1000, flash:0, axis:'h', minX:25,       maxX:PBW-113},
    {x:cx-80, y:190, w:12, h:44, vx:0,    vy:1.2,  col:'#3b82f6', lbl:'OP',     pts:150,  flash:0, axis:'v', minY:150,      maxY:280},
    {x:cx+68, y:220, w:12, h:44, vx:0,    vy:-1.2, col:'#3b82f6', lbl:'20',     pts:150,  flash:0, axis:'v', minY:150,      maxY:280},
  ];
  pbTargets = [
    {x:25,      y:PBH*0.35, w:16, h:55, hit:false, pts:80, col:'#fbbf24'},
    {x:PBW-41,  y:PBH*0.35, w:16, h:55, hit:false, pts:80, col:'#fbbf24'},
    {x:25,      y:PBH*0.55, w:16, h:55, hit:false, pts:80, col:'#f472b6'},
    {x:PBW-41,  y:PBH*0.55, w:16, h:55, hit:false, pts:80, col:'#f472b6'},
  ];
  pbScore=0; pbMult=1; pbMultTimer=0; pbLives=3; ballLaunched=false;
  pbUpdateUI();
}

function pbUpdateUI() {
  const sc=document.getElementById('pbScore'); if(sc) sc.textContent=pbScore.toLocaleString();
  const bs=document.getElementById('pbBest'); if(bs) bs.textContent=pbBest.toLocaleString();
  for(let i=0;i<3;i++){const el=document.getElementById('life'+i); if(el) el.className='life-cat '+(i<pbLives?'alive':'');}
  const mf=document.getElementById('multFill'); if(mf) mf.style.width=Math.min((pbMult-1)/4,1)*100+'%';
  const mv=document.getElementById('multVal'); if(mv) mv.textContent='x'+pbMult.toFixed(1);
}

function pbStart() {
  if(pbState==='playing') return;
  pbInit(); pbState='playing';
  const btn=document.getElementById('pbStartBtn'); if(btn) btn.textContent='üöÄ Playing...';
  ballLaunched=true; pbBall.vy=-9; pbBall.vx=(Math.random()-0.5)*4;
  pbLoop();
}

function pbReset() {
  cancelAnimationFrame(pbRaf); pbState='idle'; pbInit();
  const btn=document.getElementById('pbStartBtn'); if(btn) btn.textContent='‚ñ∂ Launch Cat!';
  pbDraw();
}

function pbLoop() { pbRaf=requestAnimationFrame(pbLoop); pbUpdate(); pbDraw(); }

function pbUpdate() {
  if(!ballLaunched) return;
  pbBall.vy += 0.28; if(pbBall.vy>13) pbBall.vy=13;
  pbBall.x += pbBall.vx; pbBall.y += pbBall.vy;

  if(pbBall.x-pbBall.r<20){pbBall.x=20+pbBall.r; pbBall.vx=Math.abs(pbBall.vx)*0.92;}
  if(pbBall.x+pbBall.r>PBW-20){pbBall.x=PBW-20-pbBall.r; pbBall.vx=-Math.abs(pbBall.vx)*0.92;}
  if(pbBall.y-pbBall.r<10){pbBall.y=10+pbBall.r; pbBall.vy=Math.abs(pbBall.vy)*0.85;}

  pbPaddles.forEach(p=>{
    if(p.axis==='h'){
      p.x+=p.vx;
      if(p.x<=p.minX||p.x>=p.maxX){p.vx*=-1; p.x=Math.max(p.minX,Math.min(p.maxX,p.x));}
    } else {
      p.y+=p.vy;
      if(p.y<=p.minY||p.y>=p.maxY){p.vy*=-1; p.y=Math.max(p.minY,Math.min(p.maxY,p.y));}
    }
    if(p.flash>0) p.flash--;

    const bx=pbBall.x, by=pbBall.y, br=pbBall.r;
    const cx2=Math.max(p.x,Math.min(bx,p.x+p.w));
    const cy2=Math.max(p.y,Math.min(by,p.y+p.h));
    const dx=bx-cx2, dy=by-cy2;
    const dist=Math.sqrt(dx*dx+dy*dy);
    if(dist<br && dist>0) {
      pbBall.x+=dx/dist*(br-dist+1);
      pbBall.y+=dy/dist*(br-dist+1);
      const overlapH=Math.min(Math.abs(bx-(p.x+p.w)), Math.abs(p.x-bx));
      const overlapV=Math.min(Math.abs(by-(p.y+p.h)), Math.abs(p.y-by));
      if(overlapV<overlapH){
        pbBall.vy=-pbBall.vy*1.05;
        if(p.axis==='h') pbBall.vx+=p.vx*0.4;
      } else {
        pbBall.vx=-pbBall.vx*1.05;
        if(p.axis==='v') pbBall.vy+=p.vy*0.4;
      }
      pbBall.vx=Math.max(-14,Math.min(14,pbBall.vx));
      pbBall.vy=Math.max(-14,Math.min(14,pbBall.vy));
      pbScore+=Math.round(p.pts*pbMult); p.flash=12;
      pbMultTimer=140; pbMult=Math.min(pbMult+0.12,5);
      pbUpdateUI();
    }
  });

  pbTargets.forEach(t=>{
    if(pbBall.x>t.x&&pbBall.x<t.x+t.w&&pbBall.y>t.y&&pbBall.y<t.y+t.h){
      pbBall.vx=-pbBall.vx*1.1;
      pbScore+=Math.round(t.pts*pbMult);
      t.hit=true; setTimeout(()=>t.hit=false,300);
      pbUpdateUI();
    }
  });

  const lAng=leftFlip?Math.PI+0.4:Math.PI-0.32;
  const rAng=rightFlip?-0.4:0.32;
  checkFlipper(pbFlippers.lx,pbFlippers.ly,pbFlippers.lw,lAng);
  checkFlipper(pbFlippers.rx,pbFlippers.ry,pbFlippers.rw,rAng);

  if(pbMultTimer>0){pbMultTimer--;}else{pbMult=Math.max(1,pbMult-0.004); pbUpdateUI();}

  if(pbBall.y>PBH+20){
    pbLives--; pbUpdateUI();
    if(pbLives<=0){pbEndGame();return;}
    pbBall.x=PBW/2; pbBall.y=PBH-130;
    pbBall.vx=(Math.random()-0.5)*3; pbBall.vy=-9;
  }
}

function checkFlipper(px,py,len,angle){
  const fx=px+Math.cos(angle)*len, fy=py+Math.sin(angle)*len;
  const ex=fx-px, ey=fy-py, lsq=ex*ex+ey*ey;
  if(lsq===0) return;
  const t=Math.max(0,Math.min(1,((pbBall.x-px)*ex+(pbBall.y-py)*ey)/lsq));
  const cpx=px+t*ex, cpy=py+t*ey;
  const dist=Math.sqrt((pbBall.x-cpx)**2+(pbBall.y-cpy)**2)||1;
  if(dist<pbBall.r+5){
    const nx=(pbBall.x-cpx)/dist, ny=(pbBall.y-cpy)/dist;
    const spd=Math.sqrt(pbBall.vx**2+pbBall.vy**2);
    pbBall.vx=nx*Math.max(spd*1.1,8);
    pbBall.vy=ny*Math.max(spd*1.1,8)-2;
    pbBall.x=cpx+nx*(pbBall.r+6);
    pbBall.y=cpy+ny*(pbBall.r+6);
  }
}

function pbDraw(){
  gc.clearRect(0,0,PBW,PBH);
  gc.fillStyle='#04040e'; gc.fillRect(0,0,PBW,PBH);
  gc.strokeStyle='rgba(247,147,26,0.03)'; gc.lineWidth=1;
  for(let x=0;x<PBW;x+=30){gc.beginPath();gc.moveTo(x,0);gc.lineTo(x,PBH);gc.stroke();}
  for(let y=0;y<PBH;y+=30){gc.beginPath();gc.moveTo(0,y);gc.lineTo(PBW,y);gc.stroke();}
  gc.strokeStyle='rgba(247,147,26,0.4)'; gc.lineWidth=2;
  gc.beginPath();gc.moveTo(20,0);gc.lineTo(20,PBH);gc.stroke();
  gc.beginPath();gc.moveTo(PBW-20,0);gc.lineTo(PBW-20,PBH);gc.stroke();
  gc.lineWidth=1;

  pbTargets.forEach(t=>{
    gc.fillStyle=t.hit?'#fff':t.col;
    gc.shadowColor=t.col; gc.shadowBlur=t.hit?14:4;
    gc.fillRect(t.x,t.y,t.w,t.h);
    gc.shadowBlur=0;
  });

  pbPaddles.forEach(p=>{
    const fl=p.flash>0;
    gc.save();
    gc.shadowColor=p.col; gc.shadowBlur=fl?28:10;
    gc.fillStyle=fl?'#ffffff':p.col;
    const r2=Math.min(p.w,p.h)/2;
    gc.beginPath(); gc.roundRect(p.x,p.y,p.w,p.h,r2); gc.fill();
    gc.fillStyle='rgba(255,255,255,0.15)';
    gc.beginPath(); gc.roundRect(p.x+2,p.y+2,p.w-4,Math.max(2,(p.h-4)*0.4),r2*0.5); gc.fill();
    gc.fillStyle=fl?p.col:'rgba(0,0,0,0.9)';
    gc.font='bold '+(p.w>40?'10':'8')+'px sans-serif';
    gc.textAlign='center'; gc.textBaseline='middle';
    gc.shadowBlur=0;
    gc.fillText(p.lbl, p.x+p.w/2, p.y+p.h/2);
    if(fl){
      gc.fillStyle='rgba(255,255,255,0.95)';
      gc.font='bold 11px monospace';
      gc.fillText('+'+p.pts, p.x+p.w/2, p.y-12);
    }
    gc.fillStyle='rgba(255,255,255,0.2)'; gc.font='9px sans-serif';
    if(p.axis==='h') gc.fillText(p.vx>0?'‚Üí':'‚Üê', p.x+p.w/2, p.y+p.h+11);
    else gc.fillText(p.vy>0?'‚Üì':'‚Üë', p.x+p.w+10, p.y+p.h/2);
    gc.restore();
  });

  const lAng=leftFlip?Math.PI+0.4:Math.PI-0.32;
  const rAng=rightFlip?-0.4:0.32;
  drawFlipper(pbFlippers.lx,pbFlippers.ly,pbFlippers.lw,lAng);
  drawFlipper(pbFlippers.rx,pbFlippers.ry,pbFlippers.rw,rAng);

  gc.strokeStyle='rgba(255,61,90,0.25)'; gc.lineWidth=1;
  gc.beginPath();gc.moveTo(20,PBH-18);gc.lineTo(PBW-20,PBH-18);gc.stroke();

  if(ballLaunched||pbState!=='idle'){
    gc.save();
    gc.shadowColor='#f472b6'; gc.shadowBlur=14;
    const bg=gc.createRadialGradient(pbBall.x-3,pbBall.y-3,1,pbBall.x,pbBall.y,pbBall.r);
    bg.addColorStop(0,'#fce7f3'); bg.addColorStop(0.5,'#ec4899'); bg.addColorStop(1,'#9d174d');
    gc.fillStyle=bg; gc.beginPath(); gc.arc(pbBall.x,pbBall.y,pbBall.r,0,Math.PI*2); gc.fill();
    gc.font='11px sans-serif'; gc.textAlign='center'; gc.textBaseline='middle';
    gc.shadowBlur=0; gc.fillText('üê±',pbBall.x,pbBall.y);
    gc.restore();
  }

  if(pbState==='idle'){
    gc.fillStyle='rgba(0,0,0,0.62)'; gc.fillRect(0,0,PBW,PBH);
    gc.save(); gc.textAlign='center';
    gc.font='bold 26px Bebas Neue,sans-serif'; gc.fillStyle='#fff';
    gc.shadowColor='#f472b6'; gc.shadowBlur=18;
    gc.fillText('üê± MOTOCAT PINBALL',PBW/2,PBH/2-22);
    gc.font='13px sans-serif'; gc.fillStyle='rgba(247,147,26,0.85)'; gc.shadowBlur=0;
    gc.fillText('Moving pong paddles as bumpers!',PBW/2,PBH/2+6);
    gc.font='11px sans-serif'; gc.fillStyle='#5a5a72';
    gc.fillText('Click or press Space to Launch',PBW/2,PBH/2+26);
    gc.restore();
  }
  if(pbState==='dead'){
    gc.fillStyle='rgba(0,0,0,0.7)'; gc.fillRect(0,0,PBW,PBH);
    gc.save(); gc.textAlign='center';
    gc.font='bold 32px Bebas Neue,sans-serif'; gc.fillStyle='#ff3d5a';
    gc.shadowColor='#ff3d5a'; gc.shadowBlur=20;
    gc.fillText('REKT! üíÄ',PBW/2,PBH/2-28);
    gc.font='18px monospace'; gc.fillStyle='#fff'; gc.shadowBlur=0;
    gc.fillText('Score: '+pbScore.toLocaleString(),PBW/2,PBH/2+6);
    gc.font='13px sans-serif'; gc.fillStyle='rgba(247,147,26,0.8)';
    gc.fillText('Click to play again',PBW/2,PBH/2+30);
    gc.restore();
  }
}

function drawFlipper(px,py,len,angle){
  const ex=px+Math.cos(angle)*len, ey=py+Math.sin(angle)*len;
  gc.save(); gc.shadowColor='#7c3aed'; gc.shadowBlur=8;
  gc.strokeStyle='#a78bfa'; gc.lineWidth=9; gc.lineCap='round';
  gc.beginPath(); gc.moveTo(px,py); gc.lineTo(ex,ey); gc.stroke();
  gc.strokeStyle='rgba(255,255,255,0.28)'; gc.lineWidth=3;
  gc.beginPath(); gc.moveTo(px,py); gc.lineTo(ex,ey); gc.stroke();
  gc.fillStyle='#c4b5fd'; gc.beginPath(); gc.arc(px,py,4,0,Math.PI*2); gc.fill();
  gc.shadowBlur=0; gc.restore();
}

function pbEndGame(){
  pbState='dead'; cancelAnimationFrame(pbRaf);
  if(pbScore>pbBest){pbBest=pbScore; localStorage.setItem('pbBest',pbBest);}
  pbLB.push(pbScore); pbLB.sort((a,b)=>b-a); pbLB=pbLB.slice(0,5);
  localStorage.setItem('pbLB',JSON.stringify(pbLB));
  renderPbLB(); pbUpdateUI();
  const btn=document.getElementById('pbStartBtn'); if(btn) btn.textContent='‚ñ∂ Launch Cat!';
  pbDraw();
}

function renderPbLB(){
  const el=document.getElementById('pbLb'); if(!el) return;
  const ranks=['g','s','b','',''];
  el.innerHTML = pbLB.length
    ? pbLB.map((s,i)=>'<div class="lb-row"><span class="lb-rank '+ranks[i]+'">#'+(i+1)+'</span><span>Run '+(i+1)+'</span><span class="lb-pts">'+s.toLocaleString()+'</span></div>').join('')
    : '<div style="font-size:11px;color:#5a5a72">No scores yet</div>';
}

document.addEventListener('keydown',e=>{
  if(e.code==='KeyZ'||e.code==='ArrowLeft') leftFlip=true;
  if(e.code==='Slash'||e.code==='ArrowRight') rightFlip=true;
  if(e.code==='Space'){e.preventDefault(); if(pbState!=='playing') pbStart();}
});
document.addEventListener('keyup',e=>{
  if(e.code==='KeyZ'||e.code==='ArrowLeft') leftFlip=false;
  if(e.code==='Slash'||e.code==='ArrowRight') rightFlip=false;
});
pbCanvas.addEventListener('touchstart',e=>{
  const rect=pbCanvas.getBoundingClientRect();
  Array.from(e.touches).forEach(t=>{
    if(t.clientX-rect.left<PBW/2) leftFlip=true; else rightFlip=true;
  });
  if(pbState!=='playing') pbStart();
},{passive:true});
pbCanvas.addEventListener('touchend',()=>{leftFlip=false;rightFlip=false;});
pbCanvas.addEventListener('mousedown',e=>{
  if(pbState!=='playing'){pbStart();return;}
  const rect=pbCanvas.getBoundingClientRect();
  if(e.clientX-rect.left<PBW/2) leftFlip=true; else rightFlip=true;
});
pbCanvas.addEventListener('mouseup',()=>{leftFlip=false;rightFlip=false;});

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// MOTOCAT RIDER
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
const riderCanvas = document.getElementById('motoRider');
const rctx = riderCanvas ? riderCanvas.getContext('2d') : null;

function drawRiderFrame(facing){
  if(!rctx) return;
  const W=140, H=70;
  rctx.clearRect(0,0,W,H);
  rctx.save();
  if(facing===-1){rctx.translate(W,0);rctx.scale(-1,1);}
  // exhaust
  rctx.fillStyle='rgba(247,147,26,0.3)';
  rctx.beginPath();rctx.arc(12,42,7,0,Math.PI*2);rctx.fill();
  rctx.beginPath();rctx.arc(5,47,4,0,Math.PI*2);rctx.fill();
  // body
  rctx.fillStyle='#f7931a';
  rctx.beginPath();rctx.roundRect(22,32,68,18,4);rctx.fill();
  // seat
  rctx.fillStyle='#2d2d2d';rctx.beginPath();rctx.roundRect(42,26,36,10,3);rctx.fill();
  // handlebars
  rctx.strokeStyle='#888';rctx.lineWidth=3;rctx.lineCap='round';
  rctx.beginPath();rctx.moveTo(78,28);rctx.lineTo(90,22);rctx.stroke();
  rctx.beginPath();rctx.moveTo(90,22);rctx.lineTo(90,30);rctx.stroke();
  // wheels
  [30,82].forEach(wx=>{
    rctx.strokeStyle='#374151';rctx.lineWidth=6;
    rctx.beginPath();rctx.arc(wx,52,14,0,Math.PI*2);rctx.stroke();
    rctx.strokeStyle='#6b7280';rctx.lineWidth=2;
    rctx.beginPath();rctx.arc(wx,52,14,0,Math.PI*2);rctx.stroke();
    rctx.fillStyle='#9ca3af';rctx.beginPath();rctx.arc(wx,52,5,0,Math.PI*2);rctx.fill();
  });
  // fork
  rctx.strokeStyle='#888';rctx.lineWidth=3;
  rctx.beginPath();rctx.moveTo(82,36);rctx.lineTo(82,52);rctx.stroke();
  rctx.beginPath();rctx.moveTo(78,36);rctx.lineTo(82,52);rctx.stroke();
  // cat body
  rctx.fillStyle='#ec4899';rctx.beginPath();rctx.roundRect(50,8,28,24,8);rctx.fill();
  // helmet
  rctx.fillStyle='#f7931a';rctx.beginPath();rctx.roundRect(52,8,24,14,6);rctx.fill();
  // visor
  rctx.fillStyle='#60a5fa';rctx.beginPath();rctx.roundRect(55,12,18,6,3);rctx.fill();
  // ears
  rctx.fillStyle='#ec4899';
  rctx.beginPath();rctx.moveTo(52,10);rctx.lineTo(46,2);rctx.lineTo(55,8);rctx.closePath();rctx.fill();
  rctx.beginPath();rctx.moveTo(76,10);rctx.lineTo(82,2);rctx.lineTo(73,8);rctx.closePath();rctx.fill();
  // eyes
  rctx.fillStyle='#fff';rctx.fillRect(55,20,5,5);rctx.fillRect(68,20,5,5);
  rctx.fillStyle='#111';rctx.fillRect(57,21,3,3);rctx.fillRect(70,21,3,3);
  // speed lines
  rctx.strokeStyle='rgba(247,147,26,0.5)';rctx.lineWidth=1.5;
  [18,24,30].forEach((y,i)=>{
    rctx.beginPath();rctx.moveTo(-14,y);rctx.lineTo(8-i*2,y);rctx.stroke();
  });
  rctx.restore();
}

let riderActive=false;
function launchRider(){
  if(riderActive||!riderCanvas) return;
  riderActive=true;
  const goRight=Math.random()>0.5;
  const startX=goRight?-160:window.innerWidth+20;
  const endX=goRight?window.innerWidth+160:-160;
  const spd=(goRight?1:-1)*(4+Math.random()*3);
  const baseY=70+Math.floor(Math.random()*140);
  riderCanvas.style.bottom=baseY+'px';
  riderCanvas.style.left=startX+'px';
  riderCanvas.style.transform=goRight?'none':'scaleX(-1)';
  riderCanvas.style.display='block';
  drawRiderFrame(goRight?1:-1);
  let posX=startX;
  function step(){
    posX+=spd;
    riderCanvas.style.left=posX+'px';
    drawRiderFrame(goRight?1:-1);
    if(goRight?posX<endX:posX>endX) requestAnimationFrame(step);
    else { riderCanvas.style.display='none'; riderActive=false; }
  }
  requestAnimationFrame(step);
}
function scheduleRider(){
  setTimeout(()=>{ launchRider(); scheduleRider(); }, 8000+Math.random()*14000);
}
scheduleRider();

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// BTC BLOCK MINER
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
const mcCanvas = document.getElementById('minerCanvas');
const mctx = mcCanvas ? mcCanvas.getContext('2d') : null;
let MCW=500, MCH=400;
let mMoto=0, mBlocks=0, mHashRate=1, mAutoRate=0;
let mBlk=[], mParticles=[], mRaf2=null, mRunning=false;

const UPGRADES=[
  {name:'GPU Rig',      baseCost:50,   costMult:2.5, hashBoost:3,  autoBoost:0.5, level:0, maxLevel:5},
  {name:'ASIC Miner',   baseCost:200,  costMult:3,   hashBoost:8,  autoBoost:2,   level:0, maxLevel:5},
  {name:'Mining Farm',  baseCost:1000, costMult:3.5, hashBoost:25, autoBoost:8,   level:0, maxLevel:5},
  {name:'Satellite Rig',baseCost:5000, costMult:4,   hashBoost:80, autoBoost:30,  level:0, maxLevel:3},
];

const BLK_COLS={btc:'#f7931a',moto:'#7c3aed',pill:'#10b981',op20:'#3b82f6',cat:'#ec4899'};
const BLK_LBL ={btc:'‚Çø',     moto:'M',       pill:'P',      op20:'OP',     cat:'üê±'};
const BLK_PTS ={btc:500,     moto:200,        pill:100,      op20:150,      cat:1000};

function resizeMC(){
  if(!mcCanvas) return;
  MCW=mcCanvas.offsetWidth||500; MCH=400;
  mcCanvas.width=MCW; mcCanvas.height=MCH;
}

function initMiner(){
  if(!mcCanvas) return;
  resizeMC();
  mBlk=[];
  const types=['btc','moto','pill','op20','cat'];
  const cols=5, bw=Math.floor((MCW-60)/cols), bh=64, gap=10;
  const rows=3;
  for(let r=0;r<rows;r++){
    for(let c=0;c<cols;c++){
      const t=types[Math.floor(Math.random()*types.length)];
      mBlk.push({x:30+c*bw, y:28+r*(bh+gap), w:bw-8, h:bh, hp:3, maxHp:3, type:t, crack:0, flash:0});
    }
  }
  mParticles=[];
  if(!mRunning){ mRunning=true; minerLoop(); }
}

function minerLoop(){
  mRaf2=requestAnimationFrame(minerLoop);
  if(mAutoRate>0&&Math.random()<mAutoRate/60){
    const alive=mBlk.filter(b=>b.hp>0);
    if(alive.length>0) mineBlock(alive[Math.floor(Math.random()*alive.length)]);
  }
  if(mBlk.every(b=>b.hp<=0)) initMiner();
  drawMiner();
}

function mineBlock(b){
  if(!b||b.hp<=0) return;
  b.hp--; b.crack=1-b.hp/b.maxHp; b.flash=8;
  for(let i=0;i<6;i++){
    mParticles.push({
      x:b.x+b.w/2, y:b.y+b.h/2,
      vx:(Math.random()-0.5)*6, vy:(-0.7-Math.random())*5,
      life:30, col:BLK_COLS[b.type],
      txt: i===0 ? '+'+BLK_PTS[b.type] : null
    });
  }
  if(b.hp<=0){
    const earned=BLK_PTS[b.type]*Math.max(1,Math.ceil(mHashRate/5));
    mMoto+=earned; mBlocks++;
    const el=document.getElementById('mMined'); if(el) el.textContent=mMoto.toLocaleString();
    const bl=document.getElementById('mBlocks'); if(bl) bl.textContent=mBlocks;
    updateUpgradeUI();
  }
}

function drawMiner(){
  if(!mctx) return;
  mctx.clearRect(0,0,MCW,MCH);
  mctx.fillStyle='#02020a'; mctx.fillRect(0,0,MCW,MCH);
  mctx.strokeStyle='rgba(247,147,26,0.04)'; mctx.lineWidth=1;
  for(let x=0;x<MCW;x+=30){mctx.beginPath();mctx.moveTo(x,0);mctx.lineTo(x,MCH);mctx.stroke();}
  for(let y=0;y<MCH;y+=30){mctx.beginPath();mctx.moveTo(0,y);mctx.lineTo(MCW,y);mctx.stroke();}

  mBlk.forEach(b=>{
    if(b.hp<=0) return;
    const col=BLK_COLS[b.type], fl=b.flash>0;
    mctx.save();
    mctx.shadowColor=col; mctx.shadowBlur=fl?20:6;
    mctx.fillStyle=fl?'#ffffff':col;
    mctx.beginPath(); mctx.roundRect(b.x,b.y,b.w,b.h,8); mctx.fill();
    // hp bar bg
    mctx.fillStyle='rgba(0,0,0,0.45)';
    mctx.beginPath(); mctx.roundRect(b.x+4,b.y+b.h-12,b.w-8,8,3); mctx.fill();
    // hp bar fill
    mctx.fillStyle='rgba(255,255,255,0.75)';
    mctx.beginPath(); mctx.roundRect(b.x+4,b.y+b.h-12,(b.w-8)*(b.hp/b.maxHp),8,3); mctx.fill();
    // cracks
    if(b.crack>0){
      mctx.strokeStyle='rgba(0,0,0,0.45)'; mctx.lineWidth=1.5; mctx.shadowBlur=0;
      mctx.beginPath(); mctx.moveTo(b.x+b.w*0.4,b.y+b.h*0.3); mctx.lineTo(b.x+b.w*0.6,b.y+b.h*0.7); mctx.stroke();
      if(b.crack>0.5){mctx.beginPath();mctx.moveTo(b.x+b.w*0.5,b.y+b.h*0.2);mctx.lineTo(b.x+b.w*0.3,b.y+b.h*0.8);mctx.stroke();}
    }
    // label
    mctx.fillStyle=fl?col:'rgba(0,0,0,0.85)';
    mctx.font='bold 20px sans-serif'; mctx.textAlign='center'; mctx.textBaseline='middle';
    mctx.shadowBlur=0;
    mctx.fillText(BLK_LBL[b.type], b.x+b.w/2, b.y+b.h/2-4);
    if(b.flash>0) b.flash--;
    mctx.restore();
  });

  mParticles.forEach(p=>{
    p.x+=p.vx; p.y+=p.vy; p.vy+=0.3; p.life--;
    const a=Math.max(0,p.life/30);
    if(p.txt){
      mctx.globalAlpha=a;
      mctx.fillStyle='#ffffff';
      mctx.font='bold 13px monospace'; mctx.textAlign='center';
      mctx.fillText(p.txt,p.x,p.y);
      mctx.globalAlpha=1;
    } else {
      const hex=Math.floor(a*255).toString(16).padStart(2,'0');
      mctx.fillStyle=p.col+hex;
      mctx.beginPath(); mctx.arc(p.x,p.y,Math.max(0.5,3*a),0,Math.PI*2); mctx.fill();
    }
  });
  mParticles=mParticles.filter(p=>p.life>0);

  // hash bar
  const hPct=Math.min(mHashRate/500,1);
  mctx.fillStyle='rgba(255,255,255,0.05)'; mctx.fillRect(0,MCH-8,MCW,8);
  mctx.fillStyle='#f7931a'; mctx.fillRect(0,MCH-8,MCW*hPct,8);

  const mhEl=document.getElementById('mHash');
  if(mhEl) mhEl.textContent=mHashRate>=1000?(mHashRate/1000).toFixed(1)+' KH/s':mHashRate+' H/s';
  const hfEl=document.getElementById('hashFill');
  if(hfEl) hfEl.style.width=(hPct*100)+'%';
}

if(mcCanvas){
  mcCanvas.addEventListener('click',e=>{
    const rect=mcCanvas.getBoundingClientRect();
    const mx=(e.clientX-rect.left)*(MCW/rect.width);
    const my=(e.clientY-rect.top)*(MCH/rect.height);
    let hit=false;
    mBlk.forEach(b=>{ if(b.hp>0&&mx>b.x&&mx<b.x+b.w&&my>b.y&&my<b.y+b.h){ mineBlock(b); hit=true; }});
    for(let i=0;i<4;i++) mParticles.push({x:mx,y:my,vx:(Math.random()-0.5)*5,vy:-2-Math.random()*3,life:20,col:'#f7931a',txt:i===0?'‚õèÔ∏è':null});
  });
  mcCanvas.addEventListener('touchstart',e=>{
    e.preventDefault();
    const rect=mcCanvas.getBoundingClientRect();
    Array.from(e.touches).forEach(t=>{
      const mx=(t.clientX-rect.left)*(MCW/rect.width);
      const my=(t.clientY-rect.top)*(MCH/rect.height);
      mBlk.forEach(b=>{ if(b.hp>0&&mx>b.x&&mx<b.x+b.w&&my>b.y&&my<b.y+b.h) mineBlock(b); });
    });
  },{passive:false});
}

function buyUpgrade(idx){
  const u=UPGRADES[idx];
  const cost=Math.floor(u.baseCost*Math.pow(u.costMult,u.level));
  if(mMoto<cost||u.level>=u.maxLevel) return;
  mMoto-=cost; u.level++;
  mHashRate+=u.hashBoost; mAutoRate+=u.autoBoost;
  const el=document.getElementById('mMined'); if(el) el.textContent=mMoto.toLocaleString();
  toast('‚ö° '+u.name+' upgraded to Lv'+u.level+'!','success');
  updateUpgradeUI();
}

function updateUpgradeUI(){
  UPGRADES.forEach((u,i)=>{
    const cost=Math.floor(u.baseCost*Math.pow(u.costMult,u.level));
    const btn=document.getElementById('upg'+i);
    const costEl=document.getElementById('upg'+i+'cost');
    if(!btn) return;
    btn.disabled=(mMoto<cost||u.level>=u.maxLevel);
    if(costEl) costEl.textContent=u.level>=u.maxLevel?'MAX':cost.toLocaleString()+' MOTO';
    const nameSpan=btn.querySelector('span:first-child');
    if(nameSpan) nameSpan.textContent=(u.level>0?'‚òÖ'.repeat(u.level)+' ':'')+u.name;
  });
}

function resetMiner(){
  UPGRADES.forEach(u=>{u.level=0;});
  mMoto=0; mBlocks=0; mHashRate=1; mAutoRate=0;
  const el=document.getElementById('mMined'); if(el) el.textContent='0';
  const bl=document.getElementById('mBlocks'); if(bl) bl.textContent='0';
  updateUpgradeUI(); initMiner();
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// FAKE LIVE TX TICKER
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
const addrPool=['bcrt1p...a1f2','bcrt1q...9c3d','bcrt1p...7e88','bcrt1q...2b14','bcrt1p...ff01'];
const amts=['0.001 rBTC','420 MOTO','1,200 PILL','0.0042 rBTC','890 MOTO'];
let txTick=0;
setInterval(()=>{
  txTick++;
  const txs=document.getElementById('recentTxs'); if(!txs) return;
  const div=document.createElement('div'); div.className='tx-item';
  const isIn=Math.random()>0.4;
  div.innerHTML='<div class="tx-dot" style="background:'+(isIn?'#00d68f':'#7c3aed')+'"></div>'
    +'<div class="tx-addr">'+addrPool[txTick%5]+'</div>'
    +'<div class="tx-amt">'+amts[txTick%5]+'</div>'
    +'<div class="tx-time">just now</div>';
  txs.insertBefore(div,txs.firstChild);
  if(txs.children.length>6) txs.removeChild(txs.lastChild);
  Array.from(txs.querySelectorAll('.tx-time')).forEach((t,i)=>{
    if(i>0) t.textContent=['5s ago','15s ago','30s ago','1m ago','2m ago'][i-1]||'2m+ ago';
  });
},7000);

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// QUOTES TICKER
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
const QUOTES=[
  {text:"Bitcoin finally has the DeFi layer it always deserved. OP_NET changes everything.",              author:"@cryptonaut_btc",    tag:"Community"},
  {text:"MotoSwap is the first true AMM on Bitcoin L1 ‚Äî no bridges, no wrapping, pure Bitcoin.",         author:"@defi_maxi",         tag:"MotoSwap"},
  {text:"Staking my MotoCats and earning real yield directly on Bitcoin. This is the future.",            author:"@nft_rider99",       tag:"MotoCats"},
  {text:"OP_20 tokens on Bitcoin L1 are a paradigm shift. AssemblyScript smart contracts are live.",     author:"@buildonbtc",        tag:"Dev"},
  {text:"The MotoSwap liquidity pools are growing fast. 38% APY with real Bitcoin security beneath.",    author:"@yield_farmer_btc",  tag:"DeFi"},
  {text:"No more ETH gas wars. OP_NET brings DeFi home ‚Äî to Bitcoin, where it belongs.",                 author:"@satoshi_descendent",tag:"Community"},
  {text:"MotoCats NFTs with on-chain utility and real yield. Finally an NFT project that delivers.",     author:"@nft_defi_degen",    tag:"MotoCats"},
  {text:"OP_NET cryptographic proofs mean every transaction is verifiable on Bitcoin's chain.",          author:"@btc_security_nerd", tag:"Tech"},
  {text:"The $MOTO token ecosystem is one of the most thoughtfully designed in Bitcoin DeFi.",           author:"@tokenomics_pro",    tag:"MOTO"},
  {text:"MotoChef farming rewards with Bitcoin-level security. That's DeFi done right.",                 author:"@chef_btc",          tag:"Farm"},
  {text:"Building on OP_NET feels like building on Ethereum circa 2020 ‚Äî except it's Bitcoin.",          author:"@dev_on_btc",        tag:"Dev"},
  {text:"The OP_WALLET extension makes interacting with Bitcoin smart contracts as easy as MetaMask.",   author:"@ux_defi",           tag:"Wallet"},
  {text:"DeFiBible is the resource the Bitcoin DeFi ecosystem needed. Everything in one place.",         author:"@knowledge_seeker",  tag:"Docs"},
  {text:"Cross-chain is overrated. Native Bitcoin DeFi with OP_NET is the real endgame.",               author:"@btc_maximalist_defi",tag:"Community"},
  {text:"Swapping OP_20 tokens on MotoSwap with 0.3% fees and Bitcoin finality. No compromise.",        author:"@low_fee_trader",    tag:"MotoSwap"},
];

function buildQuotes(){
  const track=document.getElementById('quoteTrack');
  if(!track) return;
  const all=[...QUOTES,...QUOTES];
  track.innerHTML=all.map(q=>
    '<div class="quote-card">'
    +'<div class="quote-text">'+q.text+'</div>'
    +'<div class="quote-author"><em>'+q.author+'</em> ¬∑ '+q.tag+'</div>'
    +'</div>'
  ).join('');
  // force reflow then set animation
  track.style.animation='none';
  track.offsetHeight; // reflow
  track.style.animation='';
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// INIT
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
window.addEventListener('resize',()=>{
  resizePB(); if(pbState==='idle') pbDraw();
  resizeMC();
});

fetchPrices();
setInterval(fetchPrices,60000);

pbInit();
pbDraw();
renderPbLB();

resizeMC();
initMiner();
updateUpgradeUI();

buildQuotes();

</script>
</body>
</html>
